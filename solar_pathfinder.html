<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SCEnergy íƒœì–‘ê´‘ Pathfinder</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: Arial, sans-serif;
    }
    body {
      display: flex;
      flex-direction: column;
    }

    /* HEADER */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #003366;
      color: white;
      padding: 10px 20px;
    }
    .header .logo {
      font-weight: bold;
      font-size: 18px;
    }
    .header .center-controls {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .header .center-controls label {
      font-size: 14px;
    }
    .header .right-controls {
      display: flex;
      align-items: center;
    }
    #addressInput {
      padding: 5px;
      width: 300px;
    }

    /* MAP */
    #map {
      flex: 1;
      position: relative;
      z-index: 1;
    }

    /* FOOTER */
    .footer {
      background: #eee;
      padding: 8px 12px;
      font-size: 12px;
      text-align: center;
    }

    /* CONTROL BUTTONS */
    .map-controls {
      position: absolute;
      z-index: 1000;
    }
    .map-controls.top-right {
      top: 10px;
      right: 10px;
    }
    .map-controls.bottom-right {
      bottom: 10px;
      right: 10px;
    }
    .control-panel {
      background: white;
      border: 1px solid #ccc;
      padding: 6px;
      border-radius: 5px;
    }
    .control-panel label {
      display: block;
      margin-bottom: 4px;
    }

    /* MODAL */
    .modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 600px;
      max-height: 85vh;
      overflow-y: auto;
      background: white;
      border: 1px solid #ccc;
      border-radius: 8px;
      z-index: 2000;
      display: none;
      flex-direction: column;
    }
    .modal.active {
      display: flex;
    }
    .modal-header {
      background: #003366;
      color: white;
      padding: 10px;
      font-weight: bold;
      display: flex;
      justify-content: space-between;
    }
    .modal-body {
      padding: 20px;
    }
    .tab {
      display: none;
    }
    .tab.active {
      display: block;
    }
    .tab-buttons {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
    }
    .tab-buttons button {
      padding: 6px 12px;
      cursor: pointer;
    }

    /* LAYER ICON MENU */
    .layer-icon:hover .layer-menu {
      display: block;
    }
    .layer-icon {
      position: relative;
      cursor: pointer;
    }
    .layer-menu {
      display: none;
      position: absolute;
      top: 30px;
      right: 0;
      background: white;
      border: 1px solid #ccc;
      padding: 10px;
      z-index: 1001;
    }

  </style>
</head>
<body>

  <!-- Header -->
  <div class="header">
    <div class="logo">SCEnergy íƒœì–‘ê´‘ Pathfinder</div>
    <div class="center-controls">
      <label><input type="radio" name="mode" value="land"> í† ì§€</label>
      <label><input type="radio" name="mode" value="roof"> ì§€ë¶•</label>
      <label><input type="checkbox" id="autoScanToggle"> ì´ë™ ì‹œ ìë™ ìŠ¤ìº”</label>
    </div>
    <div class="right-controls">
      <input type="text" id="addressInput" placeholder="ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”" />
    </div>
  </div>

  <!-- Map -->
  <div id="map"></div>

  <!-- Footer -->
  <div class="footer">
    ì‹œìŠ¤í…œ ìƒíƒœ ë©”ì‹œì§€ í‘œì‹œ ì˜ì—­ (ì ‘ì´ì‹)
  </div>

  <!-- Controls -->
  <div class="map-controls top-right">
    <div class="control-panel layer-icon">
      ğŸ—ºï¸ Layer
      <div class="layer-menu">
        <label><input type="checkbox" id="layerCadastre"> ì§€ì ë„</label>
        <label><input type="checkbox" id="layerKEPCO"> í•œì „ì„ ë¡œ</label>
        <label><input type="checkbox" id="layerSubstation"> ë³€ì „ì†Œ</label>
        <label><input type="checkbox" id="layerPV"> ê¸°ì„¤ì¹˜ íƒœì–‘ê´‘</label>
        <label><input type="checkbox" id="layerVWorldSat"> V-World ìœ„ì„±ì§€ë„</label>
      </div>
    </div>
  </div>

  <div class="map-controls bottom-right">
    <div class="control-panel">
      <button onclick="panMap('up')">â¬†ï¸</button><br/>
      <button onclick="panMap('left')">â¬…ï¸</button>
      <button onclick="panMap('right')">â¡ï¸</button><br/>
      <button onclick="panMap('down')">â¬‡ï¸</button><br/>
      <button onclick="zoomMap('+')">â• ì¤Œì¸</button>
      <button onclick="zoomMap('-')">â– ì¤Œì•„ì›ƒ</button>
    </div>
  </div>

  <!-- ìƒì„¸ ì„¤ì • íŒì—… -->
  <div id="settingsModal" class="modal">
    <div class="modal-header">
      <span>âš™ï¸ ìƒì„¸ ì„¤ì •</span>
      <button onclick="closeSettings()">âœ–ï¸</button>
    </div>
    <div class="modal-body">
      <div class="tab-buttons">
        <button onclick="showTab('tab1')">ì¼ë°˜/ì„¤ì¹˜</button>
        <button onclick="showTab('tab2')">ê¸ˆìœµ/PF</button>
        <button onclick="showTab('tab3')">ì „ìˆ˜ ìŠ¤ìº”</button>
      </div>

      <div id="tab1" class="tab active">
        <label>ëª¨ë“ˆ ì„ íƒ: <select id="moduleSelect"></select></label>
        <label>ì¸ë²„í„° ì„ íƒ: <select id="inverterSelect"></select></label>
        <label>ì„¤ì¹˜ ê°ë„: <input type="number" id="tiltInput"/></label>
        <label>ë°©ìœ„ê°: <input type="number" id="azimuthInput"/></label>
        <label>ì„¤ì¹˜ ë†’ì´(m): <input type="number" id="mountHeightInput"/></label>
        <label>íŒ¨ë„ ì´ê²©ê±°ë¦¬(m): <input type="number" id="panelSpacingInput"/></label>
      </div>

      <div id="tab2" class="tab">
        <label>REC ê°€ê²©: <input type="number" id="recPriceInput" oninput="reCalculate()"/></label>
        <label>SMP ê°€ê²©: <input type="number" id="smpPriceInput" oninput="reCalculate()"/></label>
        <label>ìê¸°ìë³¸ë¹„ìœ¨(%): <input type="number" id="equityRatioInput" oninput="reCalculate()"/></label>
        <label>ëŒ€ì¶œ ê¸ˆë¦¬(%): <input type="number" id="loanRateInput" oninput="reCalculate()"/></label>
      </div>

      <div id="tab3" class="tab">
        <label>ê²€ìƒ‰ ë°˜ê²½(m): <input type="number" id="scanRadiusInput"/></label>
        <button onclick="runFullScan()">ìŠ¤ìº” ì‹œì‘</button>
        <button onclick="window.open('report_latest.html?view=list', '_blank')">ğŸ“„ ê²°ê³¼ ë¦¬í¬íŠ¸ ë³´ê¸°</button>
      </div>
    </div>
  </div>

  <!-- ì„¤ì • ë²„íŠ¼ -->
  <button onclick="openSettings()" style="position: fixed; top: 70px; left: 20px; z-index: 1001;">âš™ï¸ ìƒì„¸ ì„¤ì •</button>

  <!-- SCRIPT -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <!-- ì—¬ê¸°ì— ê¸°ì¡´ JS ë¡œì§ ìŠ¤í¬ë¦½íŠ¸ ì‚½ì… -->
  <script>
    // ê¸°ì¡´ ì§€ë„ ì´ˆê¸°í™”, ì´ë²¤íŠ¸ ë“±ë¡ ë“± JS ì½”ë“œ ì‚½ì… (ì‚­ì œ ê¸ˆì§€)

    // ì˜ˆì‹œ: ê²€ìƒ‰ì°½ ì—”í„° ì´ë²¤íŠ¸ ì—°ê²°
    document.getElementById('addressInput').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        searchAddress(); // ê¸°ì¡´ í•¨ìˆ˜
      }
    });

    // ëª¨ë‹¬ ì„¤ì •
    function openSettings() {
      document.getElementById('settingsModal').classList.add('active');
    }
    function closeSettings() {
      document.getElementById('settingsModal').classList.remove('active');
    }
    function showTab(tabId) {
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      document.getElementById(tabId).classList.add('active');
    }

    // ì§€ë„ ì¡°ì‘ í•¨ìˆ˜ (ì˜ˆì‹œ)
    function panMap(direction) {
      // leaflet ì§€ë„ ê°ì²´ë¡œ ì´ë™ ë°©í–¥ ì²˜ë¦¬ (map.panBy ë“±)
    }
    function zoomMap(type) {
      // leaflet map.zoomIn / zoomOut
    }
  </script>
</body>
</html>
